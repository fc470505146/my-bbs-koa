(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56e296bb"],{"0104":function(t,e,a){},"0f33":function(t,e,a){"use strict";a("e437")},"1a2f":function(t,e,a){"use strict";a("c836")},"4e82":function(t,e,a){"use strict";var s=a("23e7"),n=a("1c0b"),r=a("7b0b"),i=a("d039"),o=a("a640"),c=[],l=c.sort,u=i((function(){c.sort(void 0)})),d=i((function(){c.sort(null)})),f=o("sort"),h=u||!d||!f;s({target:"Array",proto:!0,forced:h},{sort:function(t){return void 0===t?l.call(r(this)):l.call(r(this),n(t))}})},c836:function(t,e,a){},ca29:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-view-wrapper"},[a("UserViewHeard"),a("UserViewContent")],1)},n=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-view-heard"},[a("el-avatar",{key:t.UserInfo.avatar,attrs:{src:t.UserInfo.avatar,size:120}}),a("div",{staticClass:"user-info"},[a("div",{staticClass:"user-nickname"},[t._v(t._s(t.UserInfo.nickname))]),t.$route.params.id===t._id?a("div",{staticClass:"user-button"},[a("el-button",{attrs:{plain:"",type:"small"},on:{click:function(e){t.handleClickShowUserInfo(),t.handleClickUpdateUserInfo()}}},[t._v("编辑信息")]),a("el-button",{attrs:{plain:"",type:"small"},on:{click:function(e){t.handleClickShowAvatar(),t.handleClickAvatarPass()}}},[t._v("修改头像")])],1):t._e()]),a("el-dialog",{attrs:{center:!0,title:"编辑个人信息",visible:t.userItem.show},on:{"update:visible":function(e){return t.$set(t.userItem,"show",e)}}},[a("el-form",{attrs:{model:t.userItem}},[a("el-form-item",{attrs:{label:"昵称"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.userItem.nickname,callback:function(e){t.$set(t.userItem,"nickname",e)},expression:"userItem.nickname"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClickShowUserInfo}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.handleClickShowUserInfo(),t.subUpdateUserInfo()}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{center:!0,title:"修改头像",visible:t.avatarShow},on:{"update:visible":function(e){t.avatarShow=e}}},[a("el-upload",{ref:"uploardAvatar",staticClass:"avatar-uploader",attrs:{"show-file-list":!1,"http-request":t.uploadAvatar,action:"0","before-upload":t.beforeAvatarUpload,"auto-upload":!1,"on-change":t.freshImg}},[t.avatar?a("el-avatar",{key:t.avatar,attrs:{size:100,src:t.avatar}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClickShowAvatar}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.handleClickShowAvatar(),t.subUpdateAvatar()}}},[t._v("确 定")])],1)],1)],1)},i=[],o=a("1da1"),c=a("5530"),l=(a("caad"),a("2532"),a("96cf"),a("24a3")),u=a("2f62"),d=a("c24f"),f=a("5c96"),h={name:"UserViewHeard",data:function(){return{UserInfo:{_id:"",avatar:"",nickname:""},userItem:{show:!1,_id:"",nickname:""},avatarShow:!1,avatar:"",headTip:"点击上传头像"}},computed:Object(c["a"])({},Object(u["b"])(["_id"])),created:function(){this.getUserInfo()},methods:{uploadAvatar:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(d["k"])(t.file);case 2:s=a.sent,0===s.code&&(Object(f["Message"])({message:"上传成功",type:"success"}),e.getUserInfo(),e.$store.dispatch("user/getInfo"));case 4:case"end":return a.stop()}}),a)})))()},beforeAvatarUpload:function(t){var e,a=null===(e=t.type)||void 0===e?void 0:e.includes("image"),s=t.size/1024/1024<=5;return a||(this.avatar=this.UserInfo.avatar,this.$message.error("请上传图片类型的文件")),s||this.$message.error("上传文件大小必须小于5MB"),a&&s},freshImg:function(t){var e=this;this.imgObj=t.raw;var a=new FileReader;a.onload=function(){e.avatar=a.result},a.readAsDataURL(this.imgObj)},subUpdateAvatar:function(){this.$refs.uploardAvatar.submit()},handleClickShowAvatar:function(){this.avatarShow=!this.avatarShow},handleClickAvatarPass:function(){this.avatar=this.UserInfo.avatar},handleClickShowUserInfo:function(){this.userItem.show=!this.userItem.show},handleClickUpdateUserInfo:function(){this.userItem._id=this._id,this.userItem.nickname=this.UserInfo.nickname},subUpdateUserInfo:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(d["j"])({nickname:t.userItem.nickname});case 2:a=e.sent,0===a.code&&(Object(f["Message"])({message:"修改成功",type:"success"}),t.getUserInfo(),t.$store.dispatch("user/getInfo"));case 4:case"end":return e.stop()}}),e)})))()},getUserInfo:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["m"])({_id:t.$route.params.id});case 2:a=e.sent,0===a.code&&(t.UserInfo=a.result.data,t.UserInfo.avatar="".concat(t.UserInfo.avatar));case 4:case"end":return e.stop()}}),e)})))()}}},v=h,m=(a("0f33"),a("2877")),p=Object(m["a"])(v,r,i,!1,null,"16f7463e",null),b=p.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-view-content"},[a("div",{staticClass:"content-button-list"},t._l(t.buttonList,(function(e,s){return a("span",{key:s,class:{selected:t.currentTabNum===s},on:{click:function(a){t.handleClickButton(s),e.clickMethod()}}},[t._v(" "+t._s(e.title)+" ")])})),0),a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleLoad,expression:"handleLoad"}],staticClass:"content-item-list",attrs:{"infinite-scroll-disabled":t.controlDisabled}},[t._l(t.showList,(function(e){return a("div",{key:e._id,staticClass:"item"},[a("div",{staticClass:"item-title ellipsis"},[a("router-link",{attrs:{to:"/bbs/post/"+e._id}},[a("span",{staticClass:"title"},[t._v(t._s(e.title))]),e.recommend?a("span",{staticClass:"title",staticStyle:{color:"#7b7e86"}},[t._v(t._s(e.recommend)+"推荐")]):t._e()])],1),a("div",{staticClass:"item-date"},[t._v(t._s(e.lastDate))])])})),t.loading?a("div",{staticClass:"disabled-warning"},[t._v("加载中...")]):t._e(),t.controlDisabled?a("div",{staticClass:"disabled-warning"},[t._v(" 没有更多了 ")]):t._e()],2)])},k=[],g=(a("fb6a"),a("d81d"),a("4e82"),a("c1df")),I=a.n(g),U={name:"UserViewContent",data:function(){return{buttonList:[{title:"发帖",clickMethod:this.getPostByUserId},{title:"推荐",clickMethod:this.getRecommendByUserId},{title:"收藏",clickMethod:this.getCollectionByUserId}],currentTabNum:0,dataList:[],showCount:15,loading:!1}},computed:{showList:function(){return this.dataList.slice(0,this.showCount)},controlDisabled:function(){return this.showCount>=this.dataList.length}},created:function(){this.getPostByUserId()},methods:{handleLoad:function(){var t=this;this.loading=!0,setTimeout((function(){t.showCount+=5,t.loading=!1}),1e3)},getCollectionByUserId:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["f"])({_id:t.$route.params.id});case 2:a=e.sent,0===a.code&&(a.result.data.postList.map((function(t){t.lastDate=I()(t.lastModified).format("YYYY-MM-DD")})),a.result.data.postList.sort((function(t,e){return Date.parse(e.lastModified)-Date.parse(t.lastModified)})),t.dataList=null===(s=a.result)||void 0===s?void 0:s.data.postList);case 4:case"end":return e.stop()}}),e)})))()},getRecommendByUserId:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["l"])({_id:t.$route.params.id});case 2:a=e.sent,0===a.code&&(a.result.data.postList.map((function(t){t.lastDate=I()(t.lastModified).format("YYYY-MM-DD")})),a.result.data.postList.sort((function(t,e){return Date.parse(e.lastModified)-Date.parse(t.lastModified)})),t.dataList=null===(s=a.result)||void 0===s?void 0:s.data.postList);case 4:case"end":return e.stop()}}),e)})))()},handleClickButton:function(t){this.currentTabNum=t},getPostByUserId:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["j"])({_id:t.$route.params.id});case 2:a=e.sent,0===a.code&&(a.result.data.map((function(t){t.lastDate=I()(t.lastModified).format("YYYY-MM-DD")})),t.dataList=a.result.data);case 4:case"end":return e.stop()}}),e)})))()}}},C=U,_=(a("1a2f"),Object(m["a"])(C,w,k,!1,null,"0f6bd786",null)),j=_.exports,y={name:"UserView",components:{UserViewHeard:b,UserViewContent:j}},O=y,L=(a("f779"),Object(m["a"])(O,s,n,!1,null,"13018d07",null));e["default"]=L.exports},e437:function(t,e,a){},f779:function(t,e,a){"use strict";a("0104")}}]);